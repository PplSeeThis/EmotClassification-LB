# –ö–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è –µ–º–æ—Ü—ñ–π —É —Ç–µ–∫—Å—Ç—ñ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é LSTM —Ç–∞ BERT-lite

## –û–ø–∏—Å

–¶–µ–π –ø—Ä–æ—î–∫—Ç —Ä–µ–∞–ª—ñ–∑—É—î —Ç–∞ –ø–æ—Ä—ñ–≤–Ω—é—î –¥–≤—ñ –º–æ–¥–µ–ª—ñ –≥–ª–∏–±–æ–∫–æ–≥–æ –Ω–∞–≤—á–∞–Ω–Ω—è ‚Äì Long Short-Term Memory (LSTM) —Ç–∞ –ø–æ–ª–µ–≥—à–µ–Ω—É –≤–µ—Ä—Å—ñ—é BERT (BERT-lite) ‚Äì –¥–ª—è –∑–∞–¥–∞—á—ñ –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –µ–º–æ—Ü—ñ–π —É —Ç–µ–∫—Å—Ç–∞—Ö —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—é –º–æ–≤–æ—é. 

–î–æ—Å–ª—ñ–¥–∂–µ–Ω–Ω—è –≤–∫–ª—é—á–∞—î:
- –ü—ñ–¥–≥–æ—Ç–æ–≤–∫—É –¥–∞–Ω–∏—Ö
- –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—é –º–æ–¥–µ–ª–µ–π
- –ù–∞–≤—á–∞–Ω–Ω—è
- –û—Ü—ñ–Ω–∫—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ
- –ê–Ω–∞–ª—ñ–∑ –≤–ø–ª–∏–≤—É –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
- –û–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω—É –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ—î–∫—Ç—É

–ü—Ä–æ—î–∫—Ç —Å–∫–ª–∞–¥–∞—î—Ç—å—Å—è –∑ –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –æ—Å–Ω–æ–≤–Ω–∏—Ö Python-—Å–∫—Ä–∏–ø—Ç—ñ–≤:

### üìÑ `preprocessing.py`
–ú—ñ—Å—Ç–∏—Ç—å —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ—ó –æ–±—Ä–æ–±–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö:
- –ù–æ—Ä–º–∞–ª—ñ–∑–∞—Ü—ñ—è
- –¢–æ–∫–µ–Ω—ñ–∑–∞—Ü—ñ—è
- –í–∏–¥–∞–ª–µ–Ω–Ω—è —Å—Ç–æ–ø-—Å–ª—ñ–≤
- –õ–µ–º–∞—Ç–∏–∑–∞—Ü—ñ—è (–∑–∞–≥–ª—É—à–∫–∞, –ø–æ—Ç—Ä–µ–±—É—î —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó –∑ –ª–µ–º–∞—Ç–∏–∑–∞—Ç–æ—Ä–æ–º –¥–ª—è —É–∫—Ä–∞—ó–Ω—Å—å–∫–æ—ó –º–æ–≤–∏)
- –†–æ–∑–¥—ñ–ª–µ–Ω–Ω—è –¥–∞—Ç–∞—Å–µ—Ç—É –Ω–∞ –Ω–∞–≤—á–∞–ª—å–Ω—É, –≤–∞–ª—ñ–¥–∞—Ü—ñ–π–Ω—É –π —Ç–µ—Å—Ç–æ–≤—É –≤–∏–±—ñ—Ä–∫–∏

### üìÑ `bert_data_preparation.py`
–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—ñ–¥–≥–æ—Ç–æ–≤–∫–∏ –¥–∞–Ω–∏—Ö —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ –¥–ª—è –º–æ–¥–µ–ª—ñ BERT:
- –¢–æ–∫–µ–Ω—ñ–∑–∞—Ü—ñ—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é BERT-—Ç–æ–∫–µ–Ω—ñ–∑–∞—Ç–æ—Ä–∞
- –°—Ç–≤–æ—Ä–µ–Ω–Ω—è DataLoader'—ñ–≤ –¥–ª—è PyTorch

### üìÑ `lstm_model.py`
–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ –º–æ–¥–µ–ª—ñ LSTM –Ω–∞ PyTorch –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –µ–º–æ—Ü—ñ–π

### üìÑ `bert_lite_model.py`
–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ –º–æ–¥–µ–ª—ñ BERT-lite –Ω–∞ PyTorch –¥–ª—è –∫–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –µ–º–æ—Ü—ñ–π

### üìÑ `training.py`
–ú—ñ—Å—Ç–∏—Ç—å —Ñ—É–Ω–∫—Ü—ñ—ó –¥–ª—è –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ –æ—Ü—ñ–Ω–∫–∏ –æ–±–æ—Ö –º–æ–¥–µ–ª–µ–π (LSTM —Ç–∞ BERT-lite):
- –¶–∏–∫–ª–∏ –Ω–∞–≤—á–∞–Ω–Ω—è
- –†–æ–∑—Ä–∞—Ö—É–Ω–æ–∫ –º–µ—Ç—Ä–∏–∫
- –†–∞–Ω–Ω—è –∑—É–ø–∏–Ω–∫–∞
- –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –º–æ–¥–µ–ª–µ–π
- –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –Ω–∞–≤—á–∞–Ω–Ω—è (–∫—Ä–∏–≤—ñ –Ω–∞–≤—á–∞–Ω–Ω—è, –º–∞—Ç—Ä–∏—Ü—ñ –ø–æ–º–∏–ª–æ–∫)

### üìÑ `emotion_classifier.py`
–°–∫—Ä–∏–ø—Ç –¥–ª—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –Ω–∞–≤—á–µ–Ω–∏—Ö –º–æ–¥–µ–ª–µ–π –¥–ª—è –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–Ω—è –µ–º–æ—Ü—ñ–π –Ω–∞ –Ω–æ–≤–∏—Ö —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö

### üìÑ `lstm_hyperparameter_experiments.py`
–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ç–∞ –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è –º–æ–¥–µ–ª—ñ LSTM

### üìÑ `bert_hyperparameter_experiments.py`
–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ–¥–µ–Ω–Ω—è –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–Ω–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ —Ç–∞ –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ –Ω–∞–≤—á–∞–Ω–Ω—è –¥–ª—è –º–æ–¥–µ–ª—ñ BERT-lite

### üìÑ `data_size_comparison.py`
–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ LSTM —Ç–∞ BERT-lite –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö –æ–±—Å—è–≥–∞—Ö –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö

## –í–∏–º–æ–≥–∏

–î–ª—è –∑–∞–ø—É—Å–∫—É —Å–∫—Ä–∏–ø—Ç—ñ–≤ –ø—Ä–æ—î–∫—Ç—É –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –Ω–∞—Å—Ç—É–ø–Ω—ñ –æ—Å–Ω–æ–≤–Ω—ñ –±—ñ–±–ª—ñ–æ—Ç–µ–∫–∏ Python:

- `torch` (PyTorch)
- `transformers` (–≤—ñ–¥ Hugging Face)
- `scikit-learn`
- `pandas`
- `numpy`
- `matplotlib`
- `seaborn`
- `nltk`
- `pymorphy2` (–æ–ø—Ü—ñ–π–Ω–æ, –¥–ª—è –ª–µ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó)

### –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π

```bash
pip install torch torchvision torchaudio transformers scikit-learn pandas numpy matplotlib seaborn nltk
# pip install pymorphy2 # –û–ø—Ü—ñ–π–Ω–æ
```

### –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤ NLTK

```python
import nltk
nltk.download('punkt')
nltk.download('stopwords')
```

## –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö

### 1. –ó–∞–≥–∞–ª—å–Ω–∞ –ø–æ–ø–µ—Ä–µ–¥–Ω—è –æ–±—Ä–æ–±–∫–∞ (–¥–ª—è LSTM —Ç–∞ —è–∫ –æ—Å–Ω–æ–≤–∞ –¥–ª—è BERT)

- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —Ñ—É–Ω–∫—Ü—ñ—ó –∑ `preprocessing.py` –¥–ª—è –æ—á–∏—â–µ–Ω–Ω—è —Ç–µ–∫—Å—Ç—ñ–≤ —Ç–∞ —ó—Ö —Ç–æ–∫–µ–Ω—ñ–∑–∞—Ü—ñ—ó
- –°—Ç–≤–æ—Ä—ñ—Ç—å —Å–ª–æ–≤–Ω–∏–∫ (vocabulary) –Ω–∞ –æ—Å–Ω–æ–≤—ñ –Ω–∞–≤—á–∞–ª—å–Ω–∏—Ö –¥–∞–Ω–∏—Ö –¥–ª—è LSTM
- –†–æ–∑–¥—ñ–ª—ñ—Ç—å –≤–∞—à –¥–∞—Ç–∞—Å–µ—Ç –Ω–∞ –Ω–∞–≤—á–∞–ª—å–Ω—É, –≤–∞–ª—ñ–¥–∞—Ü—ñ–π–Ω—É —Ç–∞ —Ç–µ—Å—Ç–æ–≤—É –≤–∏–±—ñ—Ä–∫–∏

### 2. –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–∏—Ö –¥–ª—è BERT-lite

- –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ `bert_data_preparation.py` –¥–ª—è —Ç–æ–∫–µ–Ω—ñ–∑–∞—Ü—ñ—ó —Ç–µ–∫—Å—Ç—ñ–≤ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ BERT-—Ç–æ–∫–µ–Ω—ñ–∑–∞—Ç–æ—Ä–∞ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `bert-base-multilingual-cased`)
- –°—Ç–≤–æ—Ä—ñ—Ç—å DataLoader'–∏, —è–∫—ñ –ø–æ–¥–∞–≤–∞—Ç–∏–º—É—Ç—å –¥–∞–Ω—ñ —É –º–æ–¥–µ–ª—å BERT-lite —É –ø–æ—Ç—Ä—ñ–±–Ω–æ–º—É —Ñ–æ—Ä–º–∞—Ç—ñ (`input_ids`, `attention_mask`, `labels`)

## –ù–∞–≤—á–∞–Ω–Ω—è –º–æ–¥–µ–ª–µ–π

–°–∫—Ä–∏–ø—Ç `training.py` –º—ñ—Å—Ç–∏—Ç—å —Ñ—É–Ω–∫—Ü—ñ—é `run_training`, —è–∫–∞ –∫–µ—Ä—É—î –ø—Ä–æ—Ü–µ—Å–æ–º –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ—ó.

### –ù–∞–≤—á–∞–Ω–Ω—è LSTM

1. –ü—ñ–¥–≥–æ—Ç—É–π—Ç–µ DataLoader'–∏ –¥–ª—è –Ω–∞–≤—á–∞–ª—å–Ω–æ—ó —Ç–∞ –≤–∞–ª—ñ–¥–∞—Ü—ñ–π–Ω–æ—ó –≤–∏–±—ñ—Ä–æ–∫
2. –°—Ç–≤–æ—Ä—ñ—Ç—å –µ–∫–∑–µ–º–ø–ª—è—Ä –º–æ–¥–µ–ª—ñ LSTM –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `—Å—Ç–≤–æ—Ä–∏—Ç–∏_lstm_–º–æ–¥–µ–ª—å` –∑ `lstm_model.py`
3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –Ω–∞–≤—á–∞–Ω–Ω—è –∑ `model_type='lstm'`

### –ù–∞–≤—á–∞–Ω–Ω—è BERT-lite

1. –ü—ñ–¥–≥–æ—Ç—É–π—Ç–µ DataLoader'–∏ –¥–ª—è BERT
2. –°—Ç–≤–æ—Ä—ñ—Ç—å –µ–∫–∑–µ–º–ø–ª—è—Ä –º–æ–¥–µ–ª—ñ BERT-lite –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é `—Å—Ç–≤–æ—Ä–∏—Ç–∏_bert_lite_–º–æ–¥–µ–ª—å` –∑ `bert_lite_model.py`
3. –ó–∞–ø—É—Å—Ç—ñ—Ç—å –Ω–∞–≤—á–∞–Ω–Ω—è –∑ `model_type='bert'`

–§—É–Ω–∫—Ü—ñ—è `run_training` –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ:
- –í—ñ–¥—Å—Ç–µ–∂—É—î –º–µ—Ç—Ä–∏–∫–∏
- –†–µ–∞–ª—ñ–∑—É—î —Ä–∞–Ω–Ω—é –∑—É–ø–∏–Ω–∫—É
- –ó–±–µ—Ä—ñ–≥–∞—î –Ω–∞–π–∫—Ä–∞—â—É –≤–µ—Ä—Å—ñ—é –º–æ–¥–µ–ª—ñ –Ω–∞ –æ—Å–Ω–æ–≤—ñ F1-–º—ñ—Ä–∏

## –ï–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏

### üî¨ –ì—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏ LSTM
`lstm_hyperparameter_experiments.py` –¥–æ–∑–≤–æ–ª—è—î —Ç–µ—Å—Ç—É–≤–∞—Ç–∏:
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å —à–∞—Ä—ñ–≤
- –†–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ–≥–æ —Å—Ç–∞–Ω—É
- –î–≤–æ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω—ñ—Å—Ç—å
- –®–≤–∏–¥–∫—ñ—Å—Ç—å –Ω–∞–≤—á–∞–Ω–Ω—è

### üî¨ –ì—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏ BERT-lite
`bert_hyperparameter_experiments.py` –¥–æ–∑–≤–æ–ª—è—î —Ç–µ—Å—Ç—É–≤–∞—Ç–∏:
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å —à–∞—Ä—ñ–≤
- –ö—ñ–ª—å–∫—ñ—Å—Ç—å –≥–æ–ª—ñ–≤ —É–≤–∞–≥–∏
- –†–æ–∑–º—ñ—Ä–Ω—ñ—Å—Ç—å –ø—Ä–∏—Ö–æ–≤–∞–Ω–æ–≥–æ —Å—Ç–∞–Ω—É
- –ì—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –Ω–∞–≤—á–∞–Ω–Ω—è

### üìä –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –æ–±—Å—è–≥—ñ–≤ –¥–∞–Ω–∏—Ö
`data_size_comparison.py` –Ω–∞–≤—á–∞—î —Ç–∞ –æ—Ü—ñ–Ω—é—î –º–æ–¥–µ–ª—ñ –Ω–∞ —Ä—ñ–∑–Ω–∏—Ö —á–∞—Å—Ç–∫–∞—Ö –¥–∞—Ç–∞—Å–µ—Ç—É:
- 10%
- 25%
- 50%
- 75%
- 100%

## –ö–ª–∞—Å–∏—Ñ—ñ–∫–∞—Ü—ñ—è –µ–º–æ—Ü—ñ–π –Ω–∞ –Ω–æ–≤–∏—Ö —Ç–µ–∫—Å—Ç–∞—Ö

–°–∫—Ä–∏–ø—Ç `emotion_classifier.py` –º—ñ—Å—Ç–∏—Ç—å —Ñ—É–Ω–∫—Ü—ñ—é `–ø–µ—Ä–µ–¥–±–∞—á–∏—Ç–∏_–µ–º–æ—Ü—ñ—é`.

### –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

1. –ó–∞–≤–∞–Ω—Ç–∞–∂—Ç–µ –Ω–∞–≤—á–µ–Ω—É –º–æ–¥–µ–ª—å —Ç–∞ —ó—ó –≤–∞–≥–∏
2. –ü—ñ–¥–≥–æ—Ç—É–π—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å–∏–Ω–≥—É:
   - **–î–ª—è LSTM**: —Å–ª–æ–≤–Ω–∏–∫ (vocab), –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ, —Ñ—É–Ω–∫—Ü—ñ—è –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å–∏–Ω–≥—É
   - **–î–ª—è BERT**: —Ç–æ–∫–µ–Ω—ñ–∑–∞—Ç–æ—Ä BERT, –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞ –¥–æ–≤–∂–∏–Ω–∞ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ—Å—Ç—ñ
3. –ü–µ—Ä–µ–¥–∞–π—Ç–µ —Ç–µ–∫—Å—Ç —É —Ñ—É–Ω–∫—Ü—ñ—é `–ø–µ—Ä–µ–¥–±–∞—á–∏—Ç–∏_–µ–º–æ—Ü—ñ—é`

## –†–µ–∑—É–ª—å—Ç–∞—Ç–∏

–î–µ—Ç–∞–ª—å–Ω–∏–π –∞–Ω–∞–ª—ñ–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –≤–∫–ª—é—á–∞—î:
- –ü–æ—Ä—ñ–≤–Ω—è–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –º–æ–¥–µ–ª–µ–π
- –û–±—á–∏—Å–ª—é–≤–∞–ª—å–Ω—É –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å
- –í–ø–ª–∏–≤ –≥—ñ–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ñ–≤
- –ê–Ω–∞–ª—ñ–∑ –ø–æ–º–∏–ª–æ–∫
- –í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—é –∫—Ä–∏–≤–∏—Ö –Ω–∞–≤—á–∞–Ω–Ω—è —Ç–∞ –º–∞—Ç—Ä–∏—Ü—å –ø–æ–º–∏–ª–æ–∫